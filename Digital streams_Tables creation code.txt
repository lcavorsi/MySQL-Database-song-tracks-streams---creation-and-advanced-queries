CREATE DATABASE SPOTIFY_STREAMS;
USE SPOTIFY_STREAMS;

CREATE TABLE ARTISTS 
(Artist_ID varchar (50) NOT NULL,
Artist_Name varchar (100) NULL,
Artist_ISNI char(20) NULL,
CONSTRAINT PK_Artists PRIMARY KEY  (Artist_ID));

CREATE TABLE SONGS
(Song_ID varchar (5) NOT NULL,	
Song_ISRC char (12) NULL,
Song_URL varchar (200) NOT NULL,
Song_Title varchar (150) NOT NULL,	
Split BOOLEAN NOT NULL,
Song_Genre varchar (50) NULL,	
Release_date DATE NOT NULL,
CONSTRAINT PK_Songs PRIMARY KEY  (Song_ID));

CREATE TABLE ARTISTS_SONGS
(Artist_ID varchar (50) NOT NULL, 	
Song_ID	varchar (5) NOT NULL,
Role varchar (50) NOT NULL,
Artist_Percentage INT NULL DEFAULT 100,
CONSTRAINT PK_Artists_Songs PRIMARY KEY  (Artist_ID, Song_ID));

CREATE TABLE STREAMS 
(Stream_ID varchar(10) NOT NULL,
Stream_Date date NOT NULL,
Country_ID INT NOT NULL,
Song_ID varchar (5) NOT NULL,
CONSTRAINT PK_Streams PRIMARY KEY  (Stream_ID));

CREATE TABLE COUNTRIES 
(Country_ID INT NOT NULL AUTO_INCREMENT,
Country_Name varchar(40) NOT NULL,
Territory_Code varchar(3) NOT NULL,
CONSTRAINT PK_Countries PRIMARY KEY  (Country_ID));


CREATE TABLE PUBLISHERS 
(Publisher_ID varchar (5) NOT NULL,
Publisher_Name varchar (50) NOT NULL,
Artist_ID varchar (50) NOT NULL,
CONSTRAINT PK_Publishers PRIMARY KEY  (Publisher_ID));


CREATE TABLE AGGREGATORS
(Agg_ID	varchar (5) NOT NULL,
Agg_Name varchar (20) NOT NULL,
Artist_ID varchar (50) NOT NULL,
CONSTRAINT PK_Aggregators PRIMARY KEY  (Agg_ID));


CREATE TABLE LABELS 
(Label_ID varchar (5) NOT NULL,	
Label_Name varchar (40) NOT NULL,
Publisher_ID varchar (5),
Artist_ID varchar (50) NOT NULL,
CONSTRAINT PK_Labels PRIMARY KEY  (Label_ID));

CREATE TABLE PROs
(PRO_ID	varchar (5) NOT NULL,
PRO_Name varchar (30) NOT NULL,
Artist_ID varchar (50) NOT NULL,
CONSTRAINT PK_PROs PRIMARY KEY  (PRO_ID));


CREATE TABLE WORKS
(Work_ID varchar (5) NOT NULL,	
Work_ISWC varchar (15) NULL,
Song_ID varchar (5) NOT NULL,	
CONSTRAINT PK_WORKS PRIMARY KEY  (Work_ID));


CREATE TABLE MECHAN_AGENTS 
(MAgent_ID varchar (5) NOT NULL,
MAgent_Name varchar (30) NOT NULL,
Artist_ID varchar (50) NOT NULL,
Publisher_ID varchar (5) NOT NULL,
CONSTRAINT PK_MECHAN_AGENTS PRIMARY KEY  (MAgent_ID));




ALTER TABLE STREAMS
ADD CONSTRAINT FK_Country_ID FOREIGN KEY (Country_ID) REFERENCES COUNTRIES (Country_ID);

ALTER TABLE STREAMS
ADD CONSTRAINT FK_Song_ID FOREIGN KEY (Song_ID) REFERENCES SONGS (Song_ID);

ALTER TABLE MECHAN_AGENTS
ADD CONSTRAINT FK_M_Artist_ID FOREIGN KEY (Artist_ID) REFERENCES ARTISTS (Artist_ID);

ALTER TABLE MECHAN_AGENTS
ADD CONSTRAINT FK_M_Publisher_ID FOREIGN KEY (Publisher_ID) REFERENCES PUBLISHERS (Publisher_ID);


ALTER TABLE PUBLISHERS
ADD CONSTRAINT FK_P_Artist_ID FOREIGN KEY (Artist_ID) REFERENCES ARTISTS (Artist_ID);


ALTER TABLE LABELS
ADD CONSTRAINT FK_Publisher_ID FOREIGN KEY (Publisher_ID) REFERENCES PUBLISHERS (Publisher_ID);

ALTER TABLE LABELS
ADD CONSTRAINT FK_L_Artist_ID FOREIGN KEY (Artist_ID) REFERENCES ARTISTS (Artist_ID);


ALTER TABLE AGGREGATORS
ADD CONSTRAINT FK_A_Artist_ID FOREIGN KEY (Artist_ID) REFERENCES ARTISTS (Artist_ID);

ALTER TABLE PROS
ADD CONSTRAINT FK_Pr_Artist_ID FOREIGN KEY (Artist_ID) REFERENCES ARTISTS (Artist_ID);

ALTER TABLE WORKS
ADD CONSTRAINT FK_W_SONG_ID FOREIGN KEY (Song_ID) REFERENCES SONGS (Song_ID);


ALTER TABLE ARTISTS_SONG
ADD CONSTRAINT FK_Arts_Sngs FOREIGN KEY (Artist_ID) REFERENCES ARTISTS (Artist_ID);
ADD CONSTRAINT FK_Arts_Sngs FOREIGN KEY (Song_ID) REFERENCES SONGS (Song_ID);


